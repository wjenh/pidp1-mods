
      TEST OF TYPE 23 DRUM EMULATION                                      Page 1


    1                   TEST OF TYPE 23 DRUM EMULATION
    2                   
    3       720061      dia=720061
    4       720062      dwc=720062
    5       720063      dcl=720063
    6       722061      dba=722061
    7       722062      dra=722062
    8                   
    9       760020      lia=760020
   10       760040      lai=760040
   11                   
   12                   // This will periodically halt.
   13                   // The program flags will show the test number starting from 1
   14                   // When it does, the AC and IO regs should match.
   15                   // When both are 0 and the flags are 0  the test is done.
   16                   
   17 00100             100/
   18                   / put a marker in mem 0
   19 00100 200302          lac (123456
   20 00101 240000          dac 0
   21                       
   22                   / write 512 words from address 0 to the drum field 0 location 0
   23 00102 760007          clf 7
   24 00103 760016          stf 6
   25                   / drum initial address, field 0 address 0
   26 00104 764000          cli
   27 00105 720061          dia
   28                   / drum word count, write 01000, 512 dec 
   29 00106 220303          lio (401000
   30 00107 720062          dwc
   31                   / drum core location, memory addr 0
   32 00110 764000          cli
   33 00111 720063          dcl
   34                   / check the busy bit
   35 00112 620270          jsp tst
   36                   
   37                   / read same into 1000
   38 00113 341000          dzm 1000
   39                   / drum initial address, read field 0 address 0
   40 00114 220304          lio (400000
   41 00115 720061          dia
   42                   / drum word count, 01000, 512 dec
   43 00116 220305          lio (001000
   44 00117 720062          dwc
   45                   / drum core location, memory addr 1000
   46 00120 220305          lio (001000
   47 00121 720063          dcl
   48 00122 620270          jsp tst
   49                   
   50 00123 200302          lac (123456
   51 00124 221000          lio 1000
   52 00125 760400          hlt
   53                   
   54                   / read/write 8 words from 1000 to drum 0,0
   55                   / this swaps the content, 1000 should end up with 123456 again
   56 00126 760007          clf 7
   57 00127 760015          stf 5

      TEST OF TYPE 23 DRUM EMULATION                                      Page 2


   58 00130 200306          lac (654321
   59 00131 241000          dac 1000
   60                   / drum initial address, read, field 0 address 0
   61 00132 220304          lio (400000
   62 00133 720061          dia
   63                   / drum word count, write, 10, 8 dec
   64 00134 220307          lio (400010
   65 00135 720062          dwc
   66                   / drum core location, memory addr 1000
   67 00136 220305          lio (1000
   68 00137 720063          dcl
   69 00140 620270          jsp tst
   70                   
   71 00141 200302          lac (123456
   72 00142 221000          lio 1000
   73 00143 760400          hlt
   74                   
   75                   / swap same back
   76                   / read/write 8 words from 1000 to drum 0,0
   77                   / this swaps the content, 1000 should end up with 654321 this time
   78 00144 760007          clf 7
   79 00145 760015          stf 5
   80 00146 760016          stf 6
   81 00147 200302          lac (123456
   82 00150 241000          dac 1000
   83                   / drum initial address, read, field 0 address 0
   84 00151 220304          lio (400000
   85 00152 720061          dia
   86                   / drum word count, write, 10, 8 dec
   87 00153 220307          lio (400010
   88 00154 720062          dwc
   89                   / drum core location, memory addr 1000
   90 00155 220305          lio (1000
   91 00156 720063          dcl
   92 00157 620270          jsp tst
   93                   
   94 00160 200306          lac (654321
   95 00161 221000          lio 1000
   96 00162 760400          hlt
   97                   
   98                   / do a wraparound write to drum addr 4095 of data at 1000, 8 wds
   99                   / 0 will have 123456 in it
  100                   / then read back from drum 0,0 to 1000 and check the value
  101                   
  102 00163 760007          clf 7
  103 00164 760014          stf 4
  104 00165 200306          lac (654321
  105 00166 241000          dac 1000
  106 00167 200302          lac (123456
  107 00170 241001          dac 1001
  108                   / drum initial address, field 0 address 7777
  109 00171 220310          lio (7777
  110 00172 720061          dia
  111                   / drum word count, write 00010, 8 dec 
  112 00173 220307          lio (400010
  113 00174 720062          dwc
  114                   / drum core location, memory addr 1000

      TEST OF TYPE 23 DRUM EMULATION                                      Page 3


  115 00175 220305          lio (1000
  116 00176 720063          dcl
  117                   / check the busy bit
  118 00177 620270          jsp tst
  119                   
  120                   / read into 1000, we are skipping the first word written, it is at drum 4095
  121 00200 341000          dzm 1000
  122 00201 341001          dzm 1001
  123                   / drum initial address, read field 0 address 0
  124 00202 220304          lio (400000
  125 00203 720061          dia
  126                   / drum word count, 00010, 8 dec
  127 00204 220311          lio (000010
  128 00205 720062          dwc
  129                   / drum core location, memory addr 1000
  130 00206 220305          lio (001000
  131 00207 720063          dcl
  132 00210 620270          jsp tst
  133                   / 1000 should have the value 123456 because of the wraparound
  134 00211 200302          lac (123456
  135 00212 221000          lio 1000
  136 00213 760400          hlt
  137                   
  138                   / do a wraparound memory fetch from drum addr 7777 into mem addr 7777, 8 wds
  139                   / 7777 will have 654321 in it, 0 will have 123456 in it
  140 00214 760007          clf 7
  141 00215 760014          stf 4
  142 00216 760016          stf 6
  143 00217 347777          dzm 7777
  144 00220 340000          dzm 0
  145                   / drum initial address, field 0 address 7777
  146 00221 220312          lio (407777
  147 00222 720061          dia
  148                   / drum word count, 00010, 8 dec 
  149 00223 220311          lio (000010
  150 00224 720062          dwc
  151                   / drum core location, read into memory addr 7777
  152 00225 220310          lio (7777
  153 00226 720063          dcl
  154                   / check the busy bit
  155 00227 620270          jsp tst
  156                   / 0000 should have the value 123456 because of the wraparound
  157 00230 200302          lac (123456
  158 00231 220000          lio 0000
  159 00232 760400          hlt
  160                   // 7777 should have the value 654321
  161 00233 760007          clf 7
  162 00234 760014          stf 4
  163 00235 760015          stf 5
  164 00236 200306          lac (654321
  165 00237 227777          lio 7777
  166 00240 760400          hlt
  167                   
  168                   // test break, chan 0. 1000 is set to nonzero. The break clears it.
  169 00241 760007          clf 7
  170 00242 760014          stf 4
  171 00243 760015          stf 5

      TEST OF TYPE 23 DRUM EMULATION                                      Page 4


  172 00244 760016          stf 6
  173 00245 700001          law 1
  174 00246 241000          dac 1000
  175 00247 200313          lac (jmp isr
  176 00250 240003          dac 3
  177 00251 720055          esm
  178 00252 220314          lio (777
  179 00253 722061          dba
  180 00254 201000          lac 1000
  181 00255 640100          sza
  182 00256 600254          jmp .-2
  183 00257 720054          lsm
  184                   / get the current drum position and display as both values
  185 00260 722062          dra
  186 00261 320277          dio tmp
  187 00262 200277          lac tmp
  188 00263 760400          hlt
  189                   
  190                   / end of test
  191 00264 760007          clf 7
  192 00265 764000          cli
  193 00266 760200          cla
  194 00267 760400          hlt
  195                   
  196                   / check the busy bit
  197 00270 240277      tst, dac tmp
  198 00271 760200      lp1, cla
  199 00272 720033           cks
  200 00273 673001           rcr 1
  201 00274 640100           sza
  202 00275 600271           jmp lp1
  203 00276 610277      lpr, jmp i tmp
  204                   
  205 00277 000000      tmp, 0
  206                   
  207 00300 341000      isr, dzm 1000
  208 00301 610001           jmp i 1
  209                   
  210 00302 123456      constants
      00303 401000
      00304 400000
      00305 001000
      00306 654321
      00307 400010
      00310 007777
      00311 000010
      00312 407777
      00313 600300
      00314 000777
  211       000100      start 100

      No errors detected
